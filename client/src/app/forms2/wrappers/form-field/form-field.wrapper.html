<ng-container *ngrxLet="formLayout$ as formLayout">
  <ng-container [ngSwitch]="formLayout">
    <ng-container *ngSwitchCase="'horizontal'">
      <ng-container [ngTemplateOutlet]="horizontalFieldWrapper"></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="'inline'">
      <ng-container [ngTemplateOutlet]="inlineFieldWrapper"></ng-container>
    </ng-container>
    <ng-container *ngSwitchCase="'vertical'">
      <ng-container [ngTemplateOutlet]="verticalFieldWrapper"></ng-container>
    </ng-container>
  </ng-container>

  <ng-template #horizontalFieldWrapper>
    <nz-form-item
      [nzGutter]="wrapper.layout.item.gutter"
      class="layout-horizontal">
      <nz-col nzFlex="auto">
        <nz-row [nzGutter]="[6, 6]">
          <ng-container *ngIf="props.label && props.hideLabel !== true">
            <nz-form-label
              *ngIf="wrapper.layout.label as label"
              [nzRequired]="
                props.required && !wrapper.display.ignoreRequiredState
              "
              [nzFor]="id"
              [nzNoColon]="true"
              [nzSpan]="label.span ? label.span : null"
              [nzXs]="label.reactive ? label.reactive.xs : null"
              [nzSm]="label.reactive ? label.reactive.sm : null"
              [nzMd]="label.reactive ? label.reactive.md : null"
              [nzLg]="label.reactive ? label.reactive.lg : null"
              [nzXl]="label.reactive ? label.reactive.xl : null"
              [nzXXl]="label.reactive ? label.reactive.xxl : null">
              <span
                nz-typography
                nzEllipsis
                [nzContent]="props.label"></span>
            </nz-form-label>
          </ng-container>
          <nz-form-control
            *ngIf="wrapper.layout.control as control"
            [nzExtra]="!showError ? descriptionTpl : undefined"
            [nzValidateStatus]="errorState"
            [nzErrorTip]="errorTpl"
            [nzSpan]="control.span ? control.span : null"
            [nzXs]="control.reactive ? control.reactive.xs : null"
            [nzSm]="control.reactive ? control.reactive.sm : null"
            [nzMd]="control.reactive ? control.reactive.md : null"
            [nzLg]="control.reactive ? control.reactive.lg : null"
            [nzXl]="control.reactive ? control.reactive.xl : null"
            [nzXXl]="control.reactive ? control.reactive.xxl : null">
            <ng-container #fieldComponent></ng-container>
            <ng-template #descriptionTpl>
              <div class="ant-form-item-extra">
                <span>{{ wrapper.display.description }}</span>
              </div>
            </ng-template>
            <ng-template
              #errorTpl
              let-control>
              <formly-validation-message
                [field]="field"></formly-validation-message>
            </ng-template>
          </nz-form-control>
        </nz-row>
      </nz-col>
      <nz-col
        nzFlex="14px"
        class="help-tooltip">
        <span
          *ngIf="wrapper.display.tooltip; else iconSpacer"
          class="icon-tooltip"
          nz-icon
          nzTheme="twotone"
          nzTwotoneColor="#bfbfbf"
          nzType="question-circle"
          nz-tooltip
          [nzTooltipTitle]="wrapper.display.tooltip"></span>
        <ng-template #iconSpacer>
          <span
            class="icon-spacer"
            nz-icon
            nzTheme="twotone"
            nzTwotoneColor="#FFFFFF"
            nzType="question-circle"></span>
        </ng-template>
      </nz-col>
    </nz-form-item>
  </ng-template>

  <ng-template #verticalFieldWrapper>
    <nz-form-item class="layout-vertical">
      <ng-container *ngIf="props.label && props.hideLabel !== true">
        <nz-form-label
          [nzRequired]="props.required && props.hideRequiredMarker !== true"
          [nzFor]="id">
          {{ props.label }}
        </nz-form-label>
      </ng-container>
      <nz-form-control
        [nzValidateStatus]="errorState"
        [nzErrorTip]="errorTpl">
        <ng-container #fieldComponent></ng-container>
        <ng-template
          #errorTpl
          let-control>
          <formly-validation-message
            [field]="field"></formly-validation-message>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
  </ng-template>

  <ng-template #inlineFieldWrapper>
    <nz-form-item class="layout-inline">
      <ng-container *ngIf="props.label && props.hideLabel !== true">
        <nz-form-label
          [nzRequired]="props.required && props.hideRequiredMarker !== true"
          [nzFor]="id">
          {{ props.label }}
        </nz-form-label>
      </ng-container>
      <nz-form-control
        [nzValidateStatus]="errorState"
        [nzErrorTip]="errorTpl">
        <ng-container #fieldComponent></ng-container>
        <ng-template
          #errorTpl
          let-control>
          <formly-validation-message
            [field]="field"></formly-validation-message>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
  </ng-template>
</ng-container>
